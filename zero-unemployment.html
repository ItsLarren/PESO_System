<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Unemployment Project - CPESO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">CPESO</div>
                <h1>Zero Unemployment Project</h1>
                <div class="user-info">
                    <span>Welcome, <span id="current-user">User</span></span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Back to FEIS button -->
        <button class="back-btn" onclick="goToFEIS()">
            <i class="fas fa-arrow-left"></i> Back to FEIS Main Page
        </button>

        <div class="card">
            <h2>Zero Unemployment Project Applicants</h2>
            <div class="project-description">
                <p><strong>Specialized program focused on achieving zero unemployment through targeted interventions and employment generation.</strong></p>
            </div>
            
            <!-- Same search and filter components as FEIS -->
            <div class="search-container">
                <input type="text" id="search-input" class="search-input" placeholder="Search Zero Unemployment applicants...">
                <button class="search-btn" id="search-btn">
                    <i class="fas fa-search"></i> Search
                </button>
                <button class="clear-search-btn" id="clear-search-btn">
                    <i class="fas fa-times"></i> Clear
                </button>
            </div>

            <!-- Same table structure as FEIS but filtered for Zero Unemployment -->
            <div class="table-container">
                <table class="applicant-table" id="zero-unemployment-table">
                    <thead>
                        <tr>
                            <th>SRS ID</th>
                            <th>SURNAME</th>
                            <th>FIRST NAME</th>
                            <th>MIDDLE NAME</th>
                            <th>DATE OF BIRTH</th>
                            <th>BARANGAY</th>
                            <th>CONTACT NUMBER</th>
                            <th>EMPLOYMENT STATUS</th>
                            <th>PROGRAM STATUS</th>
                            <th>REGISTRATION DATE</th>
                            <th class="actions-cell">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button id="add-zero-applicant-btn" class="add-btn">
                    <i class="fas fa-user-plus"></i> Add Zero Unemployment Applicant
                </button>
                <button id="export-zero-applicants-btn" class="export-applicants-btn">
                    <i class="fas fa-file-excel"></i> Export to Excel
                </button>
            </div>
        </div>

        <!-- Same modals as FEIS but for Zero Unemployment -->
        <div class="card">
            <h2>Add New Zero Unemployment Applicant</h2>
            <div class="import-section">
                <button class="add-btn" id="add-manual-zero-btn">
                    <i class="fas fa-user-plus"></i> Add New Applicant Manually
                </button>
            </div>
        </div>
    </div>

    <!-- Same modals as FEIS -->
    <div id="viewModal" class="modal">
        <!-- Same view modal content as FEIS -->
    </div>

    <div id="editModal" class="modal">
        <!-- Same edit modal content as FEIS -->
    </div>

    <div id="manualModal" class="modal">
        <!-- Same manual modal content as FEIS -->
    </div>

    <script>
        // Zero Unemployment Project specific JavaScript
        const ZERO_UNEMPLOYMENT_STORAGE_KEY = 'zeroUnemploymentApplicants';
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.href = 'login.html';
                return;
            }

            // Display current user
            const currentUser = localStorage.getItem('currentUser') || 'User';
            document.getElementById('current-user').textContent = currentUser;

            // Load and display Zero Unemployment applicants
            loadZeroUnemploymentApplicants();

            // Initialize event listeners
            initializeZeroUnemploymentEvents();
        });

        function loadZeroUnemploymentApplicants() {
            const zeroApplicants = JSON.parse(localStorage.getItem(ZERO_UNEMPLOYMENT_STORAGE_KEY)) || [];
            displayZeroUnemploymentApplicants(zeroApplicants);
        }

        function displayZeroUnemploymentApplicants(applicants) {
            const tbody = document.getElementById('zero-unemployment-table').querySelector('tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (applicants.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 11;
                cell.className = 'no-results';
                cell.textContent = 'No Zero Unemployment applicants found';
                row.appendChild(cell);
                tbody.appendChild(row);
                return;
            }
            
            applicants.forEach(applicant => {
                const row = document.createElement('tr');
                
                const columns = [
                    applicant['SRS ID'] || 'N/A',
                    applicant['LAST NAME'] || applicant['SURNAME'] || 'N/A',
                    applicant['FIRST NAME'] || 'N/A',
                    applicant['MIDDLE NAME'] || 'N/A',
                    applicant['DATE OF BIRTH'] || applicant['BDATE'] || 'N/A',
                    applicant['BARANGAY'] || 'N/A',
                    applicant['CELLPHONE NUMBER'] || applicant['CELLPHONE'] || 'N/A',
                    applicant['EMPLOYMENT STATUS/TYPE'] || applicant['EMP. STATUS'] || 'N/A',
                    applicant['PROGRAM STATUS'] || 'N/A',
                    applicant['REG. DATE'] || 'N/A'
                ];
                
                columns.forEach(value => {
                    const cell = document.createElement('td');
                    cell.textContent = value;
                    row.appendChild(cell);
                });
                
                // Actions cell
                const actionsCell = document.createElement('td');
                actionsCell.className = 'actions-cell';
                actionsCell.innerHTML = `
                    <div class="action-buttons">
                        <button class="view-btn" title="View">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="edit-btn" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="download-btn" title="Download">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="delete-btn" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                // Add event listeners
                const viewBtn = actionsCell.querySelector('.view-btn');
                const editBtn = actionsCell.querySelector('.edit-btn');
                const deleteBtn = actionsCell.querySelector('.delete-btn');
                const downloadBtn = actionsCell.querySelector('.download-btn');
                
                viewBtn.addEventListener('click', () => openViewModal(applicant));
                editBtn.addEventListener('click', () => openEditModal(applicant));
                deleteBtn.addEventListener('click', () => deleteZeroApplicant(applicant['SRS ID']));
                downloadBtn.addEventListener('click', () => downloadApplicantData(applicant));
                
                row.appendChild(actionsCell);
                tbody.appendChild(row);
            });
        }

        function initializeZeroUnemploymentEvents() {
            // Add manual applicant button
            document.getElementById('add-manual-zero-btn').addEventListener('click', function() {
                openManualModal(true); // true indicates Zero Unemployment context
            });

            // Export button
            document.getElementById('export-zero-applicants-btn').addEventListener('click', exportZeroApplicantsToExcel);

            // Search functionality
            document.getElementById('search-btn').addEventListener('click', searchZeroApplicants);
            document.getElementById('clear-search-btn').addEventListener('click', clearZeroSearch);
        }

        function openManualModal(isZeroUnemployment = false) {
            // Your existing manual modal code, but set program category to "Zero Unemployment"
            const manualModal = document.getElementById('manualModal');
            if (manualModal) {
                // Set program category to Zero Unemployment
                const programCategorySelect = document.getElementById('manual-program-category');
                if (programCategorySelect && isZeroUnemployment) {
                    programCategorySelect.value = 'Zero Unemployment';
                    programCategorySelect.disabled = true; // Lock it for Zero Unemployment
                }
                
                manualModal.style.display = 'block';
            }
        }

        function deleteZeroApplicant(applicantId) {
            if (confirm('Are you sure you want to delete this Zero Unemployment applicant?')) {
                const zeroApplicants = JSON.parse(localStorage.getItem(ZERO_UNEMPLOYMENT_STORAGE_KEY)) || [];
                const updatedApplicants = zeroApplicants.filter(applicant => applicant['SRS ID'] !== applicantId);
                
                localStorage.setItem(ZERO_UNEMPLOYMENT_STORAGE_KEY, JSON.stringify(updatedApplicants));
                loadZeroUnemploymentApplicants();
                showNotification('Zero Unemployment applicant deleted successfully!', 'success');
            }
        }

        function exportZeroApplicantsToExcel() {
            const zeroApplicants = JSON.parse(localStorage.getItem(ZERO_UNEMPLOYMENT_STORAGE_KEY)) || [];
            if (zeroApplicants.length === 0) {
                showNotification('No Zero Unemployment applicants to export', 'error');
                return;
            }
            
            // Your existing export code, but for Zero Unemployment data
            const exportData = zeroApplicants.map(applicant => ({
                'SRS ID': applicant['SRS ID'] || '',
                'Last Name': applicant['LAST NAME'] || '',
                'First Name': applicant['FIRST NAME'] || '',
                'Middle Name': applicant['MIDDLE NAME'] || '',
                'Birth Date': applicant['DATE OF BIRTH'] || '',
                'Barangay': applicant['BARANGAY'] || '',
                'Contact Number': applicant['CELLPHONE'] || '',
                'Employment Status': applicant['EMP. STATUS'] || '',
                'Program Status': applicant['PROGRAM STATUS'] || '',
                'Registration Date': applicant['REG. DATE'] || ''
            }));
            
            const worksheet = XLSX.utils.json_to_sheet(exportData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Zero Unemployment Applicants");
            
            const today = new Date().toISOString().split('T')[0];
            XLSX.writeFile(workbook, `zero_unemployment_applicants_${today}.xlsx`);
            
            showNotification('Zero Unemployment applicants exported successfully!', 'success');
        }

        function searchZeroApplicants() {
            // Your existing search functionality adapted for Zero Unemployment
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            const zeroApplicants = JSON.parse(localStorage.getItem(ZERO_UNEMPLOYMENT_STORAGE_KEY)) || [];
            
            if (!searchTerm) {
                displayZeroUnemploymentApplicants(zeroApplicants);
                return;
            }
            
            const filteredApplicants = zeroApplicants.filter(applicant => {
                const searchableText = Object.values(applicant).join(' ').toLowerCase();
                return searchableText.includes(searchTerm);
            });
            
            displayZeroUnemploymentApplicants(filteredApplicants);
        }

        function clearZeroSearch() {
            document.getElementById('search-input').value = '';
            loadZeroUnemploymentApplicants();
        }

        function goToFEIS() {
            window.location.href = 'index.html';
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        }

        // Utility function for notifications
        function showNotification(message, type) {
            // Your existing notification code
            console.log(`${type.toUpperCase()}: ${message}`);
        }
    </script>
</body>
</html>